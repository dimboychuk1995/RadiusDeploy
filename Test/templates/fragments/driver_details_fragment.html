<h1>Driver Details</h1>

<!-- üîô –ö–Ω–æ–ø–∫–∞ –ù–∞–∑–∞–¥ -->
<button type="button" class="btn btn-secondary mb-3" id="backToDriversBtn">
    ‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –≤–æ–¥–∏—Ç–µ–ª–µ–π
</button>

<!-- üìù –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
<form action="{{ url_for('drivers.edit_driver', driver_id=driver._id) }}" method="POST" id="editForm" data-driver-id="{{ driver._id }}">
    <div class="form-group">
        <label>–ò–º—è</label>
        <input type="text" class="form-control" name="name" value="{{ driver.name }}" disabled>
    </div>
    <div class="form-group">
        <label>–ù–æ–º–µ—Ä –ª–∏—Ü–µ–Ω–∑–∏–∏</label>
        <input type="text" class="form-control" name="license_number" value="{{ driver.license_number }}" disabled>
    </div>
    <div class="form-group">
        <label>–¢–µ–ª–µ—Ñ–æ–Ω</label>
        <input type="text" class="form-control" name="contact_number" value="{{ driver.contact_number }}" disabled>
    </div>
    <div class="form-group">
        <label>–¢—Ä–∞–∫</label>
        <select class="form-control" name="truck" disabled>
            {% for t in trucks | default([]) %}
                <option value="{{ t._id }}" {% if truck and t._id == truck._id %}selected{% endif %}>
                    {{ t.unit_number }} - {{ t.make }} {{ t.model }}
                </option>
            {% endfor %}
        </select>
    </div>
    <div class="form-group">
        <label>–î–∏—Å–ø–µ—Ç—á–µ—Ä</label>
        <select class="form-control" name="dispatcher" disabled>
            {% for d in dispatchers | default([]) %}
                <option value="{{ d._id }}" {% if dispatcher and d._id == dispatcher._id %}selected{% endif %}>
                    {{ d.username }}
                </option>
            {% endfor %}
        </select>
    </div>
    <button type="submit" class="btn btn-success d-none" id="saveBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    <button type="button" class="btn btn-secondary" id="editBtn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
</form>

<!-- üí∞ –ö–Ω–æ–ø–∫–∞ –º–æ–¥–∞–ª–∫–∏ -->
<button type="button" class="btn btn-info mt-3" data-toggle="modal" data-target="#salarySchemeModal">
    üí∞ –°—Ö–µ–º–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã
</button>

<!-- üíº –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
<div class="modal fade" id="salarySchemeModal" tabindex="-1" role="dialog" aria-labelledby="salarySchemeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <form id="salarySchemeForm" data-driver-id="{{ driver._id }}">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="salarySchemeModalLabel">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ö–µ–º—ã –∑–∞—Ä–ø–ª–∞—Ç—ã</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">

            <!-- –í—ã–±–æ—Ä —Ç–∏–ø–∞ —Å—Ö–µ–º—ã -->
            <div class="form-group">
                <label>–°—Ö–µ–º–∞ —Ä–∞—Å—á—ë—Ç–∞</label>
                <select class="form-control" name="scheme_type" id="schemeTypeSelect">
                    <option value="percent" {% if scheme_data.scheme_type == 'percent' %}selected{% endif %}>–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —Å—É–º–º—ã –≥—Ä—É–∑–æ–≤</option>
                    <option value="net_percent" {% if scheme_data.scheme_type == 'net_percent' %}selected{% endif %}>–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏</option>
                </select>
            </div>

            <!-- üíµ –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —Å—É–º–º—ã -->
            <div id="percentSchemeBlock" {% if scheme_data.scheme_type != 'percent' %}style="display: none;"{% endif %}>
                <div class="form-group">
                    <label>–ë–∞–∑–æ–≤—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç $0:</label>
                    <input type="number" step="0.01" name="base_percent" class="form-control"
                           value="{{ scheme_data.commission_table[0].percent if scheme_data.commission_table and scheme_data.commission_table[0].from_sum == 0 else 30 }}">
                </div>

                <label>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏:</label>
                <div id="commissionTable">
                    {% for entry in scheme_data.commission_table[1:] %}
                    <div class="form-row mb-2">
                        <div class="col">
                            <input type="number" step="0.01" class="form-control" name="gross_from_sum[]" value="{{ entry.from_sum }}" placeholder="–æ—Ç —Å—É–º–º—ã ($)">
                        </div>
                        <div class="col">
                            <input type="number" step="0.01" class="form-control" name="gross_percent[]" value="{{ entry.percent }}" placeholder="–ü—Ä–æ—Ü–µ–Ω—Ç (%)">
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <button type="button" class="btn btn-sm btn-outline-secondary" id="addCommissionRow">+ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É</button>
            </div>

            <!-- üìâ –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏ -->
            <div id="netPercentBlock" {% if scheme_data.scheme_type == 'percent' %}style="display: none;"{% endif %}>
                <div class="form-group">
                    <label>–ë–∞–∑–æ–≤—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç $0:</label>
                    <input type="number" step="0.01" name="base_percent" class="form-control"
                           value="{{ scheme_data.net_commission_table[0].percent if scheme_data.net_commission_table and scheme_data.net_commission_table[0].from_sum == 0 else 30 }}">
                </div>

                <label>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏:</label>
                <div id="netCommissionTable">
                    {% for entry in scheme_data.net_commission_table[1:] %}
                    <div class="form-row mb-2">
                        <div class="col">
                            <input type="number" step="0.01" class="form-control" name="net_from_sum[]" value="{{ entry.from_sum }}" placeholder="–æ—Ç —Å—É–º–º—ã ($)">
                        </div>
                        <div class="col">
                            <input type="number" step="0.01" class="form-control" name="net_percent[]" value="{{ entry.percent }}" placeholder="–ü—Ä–æ—Ü–µ–Ω—Ç (%)">
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <button type="button" class="btn btn-sm btn-outline-secondary" id="addNetCommissionRow">+ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É</button>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
          <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ö–µ–º—É</button>
        </div>
      </div>
    </form>
  </div>
</div>

<!-- üîç –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞ -->
<div class="alert alert-info mt-3">Driver ID: {{ driver._id }}</div>
