<h1>–î–µ—Ç–∞–ª–∏ –≤–æ–¥–∏—Ç–µ–ª—è</h1>

<!-- üñô –ö–Ω–æ–ø–∫–∞ –ù–∞–∑–∞–¥ -->
<button type="button" class="btn btn-secondary mb-3" id="backToDriversBtn">
    ‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –≤–æ–¥–∏—Ç–µ–ª–µ–π
</button>

<!-- üë§ –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
<div class="card mb-4">
  <div class="card-header">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
  <div class="card-body">
    <p><strong>–ò–º—è:</strong> {{ driver.name }}</p>
    <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> {{ driver.contact_number }}</p>
    <p><strong>–ê–¥—Ä–µ—Å:</strong> {{ driver.address }}</p>
    <p><strong>Email:</strong> {{ driver.email }}</p>
    <p><strong>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</strong> {{ driver.dob }}</p>
    <p><strong>–¢–∏–ø –≤–æ–¥–∏—Ç–µ–ª—è:</strong> {{ driver.driver_type }}</p>
  </div>
</div>

<!-- üó™ –õ–∏—Ü–µ–Ω–∑–∏—è -->
<div class="card mb-4">
  <div class="card-header">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª–∏—Ü–µ–Ω–∑–∏–∏</div>
  <div class="card-body">
    <p><strong>–ù–æ–º–µ—Ä:</strong> {{ driver.license.number }}</p>
    <p><strong>–ö–ª–∞—Å—Å:</strong> {{ driver.license.class }}</p>
    <p><strong>–®—Ç–∞—Ç:</strong> {{ driver.license.state }}</p>
    <p><strong>–ê–¥—Ä–µ—Å:</strong> {{ driver.license.address }}</p>
    <p><strong>–î–∞—Ç–∞ –≤—ã–¥–∞—á–∏:</strong> {{ driver.license.issued_date }}</p>
    <p><strong>–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è:</strong> {{ driver.license.expiration_date }}</p>
    <p><strong>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</strong> {{ driver.license.restrictions }}</p>
    {% if driver.license.file_id %}
    <p><strong>–§–∞–π–ª:</strong> <a href="/get_file/{{ driver.license.file_id }}" target="_blank">–°–∫–∞—á–∞—Ç—å</a></p>
    {% endif %}
  </div>
</div>

<!-- üè• –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç -->
<div class="card mb-4">
  <div class="card-header">–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</div>
  <div class="card-body">
    <p><strong>–î–∞—Ç–∞ –≤—ã–¥–∞—á–∏:</strong> {{ driver.medical_card.issued_date }}</p>
    <p><strong>–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è:</strong> {{ driver.medical_card.expiration_date }}</p>
    <p><strong>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</strong> {{ driver.medical_card.restrictions }}</p>
    {% if driver.medical_card.file_id %}
    <p><strong>–§–∞–π–ª:</strong> <a href="/get_file/{{ driver.medical_card.file_id }}" target="_blank">–°–∫–∞—á–∞—Ç—å</a></p>
    {% endif %}
  </div>
</div>

<!-- ü§Æ –î—Ä–∞–≥ —Ç–µ—Å—Ç -->
<div class="card mb-4">
  <div class="card-header">–î—Ä–∞–≥ —Ç–µ—Å—Ç</div>
  <div class="card-body">
    <p><strong>–î–∞—Ç–∞ —Ç–µ—Å—Ç–∞:</strong> {{ driver.drug_test.issued_date }}</p>
    {% if driver.drug_test.file_id %}
    <p><strong>–§–∞–π–ª:</strong> <a href="/get_file/{{ driver.drug_test.file_id }}" target="_blank">–°–∫–∞—á–∞—Ç—å</a></p>
    {% endif %}
  </div>
</div>

<!-- üöõ –¢—Ä–∞–∫ –∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä -->
<div class="card mb-4">
  <div class="card-header">–ü—Ä–∏–≤—è–∑–∫–∏</div>
  <div class="card-body">
    <p><strong>–¢—Ä–∞–∫:</strong> {% if truck %}{{ truck.unit_number }} - {{ truck.make }} {{ truck.model }}{% else %}–ù–µ—Ç{% endif %}</p>
    <p><strong>–î–∏—Å–ø–µ—Ç—á–µ—Ä:</strong> {% if dispatcher %}{{ dispatcher.username }}{% else %}–ù–µ—Ç{% endif %}</p>
  </div>
</div>

<!-- üí∞ –ö–Ω–æ–ø–∫–∞ –º–æ–¥–∞–ª–∫–∏ –∑–∞—Ä–ø–ª–∞—Ç—ã -->
<button type="button" class="btn btn-info mt-3" onclick="openSalaryModal()">üí∞ –°—Ö–µ–º–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã</button>

<!-- üíº –ú–æ–¥–∞–ª–∫–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã -->
<!-- –í–°–¢–ê–í–õ–Ø–ï–ú –°–Æ–î–ê –ü–û–õ–ù–´–ô –ö–û–î –ú–û–î–ê–õ–ö–ò -->
<!-- ... –º–æ–¥–∞–ª–∫–∞, –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–∏, —É–∂–µ –≤—Å—Ç–∞–≤–ª–µ–Ω–∞ —Å—é–¥–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é ... -->
<div class="custom-offcanvas custom-offcanvas-right" id="salarySchemeModal">
  <div class="custom-offcanvas-content">
    <div class="custom-offcanvas-header">
      <h5 class="modal-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ö–µ–º—ã –∑–∞—Ä–ø–ª–∞—Ç—ã</h5>
      <button type="button" class="close" onclick="closeSalaryModal()">
        <span>&times;</span>
      </button>
    </div>
    <div class="custom-offcanvas-body">
      <form id="salarySchemeForm" data-driver-id="{{ driver._id }}">
        <div class="form-group">
          <label>–°—Ö–µ–º–∞ —Ä–∞—Å—á—ë—Ç–∞</label>
          <select class="form-control" name="scheme_type" id="schemeTypeSelect">
            <option value="percent" {% if scheme_data.scheme_type == 'percent' %}selected{% endif %}>–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —Å—É–º–º—ã –≥—Ä—É–∑–æ–≤</option>
            <option value="net_percent" {% if scheme_data.scheme_type == 'net_percent' %}selected{% endif %}>–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏</option>
          </select>
        </div>
        <div id="percentSchemeBlock" {% if scheme_data.scheme_type != 'percent' %}style="display: none;"{% endif %}>
          <div class="form-group">
            <label>–ë–∞–∑–æ–≤—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç $0:</label>
            <input type="number" step="0.01" name="base_percent" class="form-control"
                   value="{{ scheme_data.commission_table[0].percent if scheme_data.commission_table and scheme_data.commission_table[0].from_sum == 0 else 30 }}">
          </div>
          <label>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏:</label>
          <div id="commissionTable">
            {% for entry in scheme_data.commission_table[1:] %}
            <div class="form-row mb-2">
              <div class="col"><input type="number" step="0.01" class="form-control" name="gross_from_sum[]" value="{{ entry.from_sum }}" placeholder="–æ—Ç —Å—É–º–º—ã ($)"></div>
              <div class="col"><input type="number" step="0.01" class="form-control" name="gross_percent[]" value="{{ entry.percent }}" placeholder="–ü—Ä–æ—Ü–µ–Ω—Ç (%)"></div>
            </div>
            {% endfor %}
          </div>
          <button type="button" class="btn btn-sm btn-outline-secondary" id="addCommissionRow">+ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É</button>
        </div>
        <div id="netPercentBlock" {% if scheme_data.scheme_type == 'percent' %}style="display: none;"{% endif %}>
          <div class="form-group">
            <label>–ë–∞–∑–æ–≤—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç $0:</label>
            <input type="number" step="0.01" name="base_percent" class="form-control"
                   value="{{ scheme_data.net_commission_table[0].percent if scheme_data.net_commission_table and scheme_data.net_commission_table[0].from_sum == 0 else 30 }}">
          </div>
          <label>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ä–æ–≤–Ω–∏:</label>
          <div id="netCommissionTable">
            {% for entry in scheme_data.net_commission_table[1:] %}
            <div class="form-row mb-2">
              <div class="col"><input type="number" step="0.01" class="form-control" name="net_from_sum[]" value="{{ entry.from_sum }}" placeholder="–æ—Ç —Å—É–º–º—ã ($)"></div>
              <div class="col"><input type="number" step="0.01" class="form-control" name="net_percent[]" value="{{ entry.percent }}" placeholder="–ü—Ä–æ—Ü–µ–Ω—Ç (%)"></div>
            </div>
            {% endfor %}
          </div>
          <button type="button" class="btn btn-sm btn-outline-secondary" id="addNetCommissionRow">+ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É</button>
        </div>
        <div class="mt-4 d-flex justify-content-end">
          <button type="button" class="btn btn-secondary mr-2" onclick="closeSalaryModal()">–û—Ç–º–µ–Ω–∞</button>
          <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ö–µ–º—É</button>
        </div>
      </form>
    </div>
  </div>
</div>
<div class="custom-offcanvas-backdrop" onclick="closeSalaryModal()"></div>
