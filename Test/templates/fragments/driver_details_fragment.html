<h1>Driver Details</h1>

<!-- –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" -->
<button type="button" class="btn btn-secondary mb-3" id="backToDriversBtn">
    ‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –≤–æ–¥–∏—Ç–µ–ª–µ–π
</button>

<!-- ‚úÖ –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
<form action="{{ url_for('drivers.edit_driver', driver_id=driver._id) }}"
      method="POST"
      id="editForm"
      data-driver-id="{{ driver._id }}">
    <div class="form-group">
        <label>–ò–º—è</label>
        <input type="text" class="form-control" name="name" value="{{ driver.name }}">
    </div>
    <div class="form-group">
        <label>–ù–æ–º–µ—Ä –ª–∏—Ü–µ–Ω–∑–∏–∏</label>
        <input type="text" class="form-control" name="license_number" value="{{ driver.license_number }}">
    </div>
    <div class="form-group">
        <label>–¢–µ–ª–µ—Ñ–æ–Ω</label>
        <input type="text" class="form-control" name="contact_number" value="{{ driver.contact_number }}">
    </div>
    <div class="form-group">
        <label>–¢—Ä–∞–∫</label>
        <select class="form-control" name="truck">
            {% for t in trucks %}
                <option value="{{ t._id }}" {% if truck and t._id == truck._id %}selected{% endif %}>
                    {{ t.unit_number }} - {{ t.make }} {{ t.model }}
                </option>
            {% endfor %}
        </select>
    </div>
    <div class="form-group">
        <label>–î–∏—Å–ø–µ—Ç—á–µ—Ä</label>
        <select class="form-control" name="dispatcher">
            {% for d in dispatchers %}
                <option value="{{ d._id }}" {% if dispatcher and d._id == dispatcher._id %}selected{% endif %}>
                    {{ d.username }}
                </option>
            {% endfor %}
        </select>
    </div>
    <button type="submit" class="btn btn-success" id="saveBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
</form>

<!-- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–°—Ö–µ–º–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã" -->
<button type="button" class="btn btn-info mt-3" data-toggle="modal" data-target="#salarySchemeModal">
    üí∞ –°—Ö–µ–º–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã
</button>

<!-- ‚úÖ –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
<div class="modal fade" id="salarySchemeModal" tabindex="-1" role="dialog" aria-labelledby="salarySchemeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <form id="salarySchemeForm" data-driver-id="{{ driver._id }}">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="salarySchemeModalLabel">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ö–µ–º—ã –∑–∞—Ä–ø–ª–∞—Ç—ã</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
            <!-- –°–µ–ª–µ–∫—Ç–æ—Ä —Å—Ö–µ–º—ã -->
            <div class="form-group">
                <label>–°—Ö–µ–º–∞ —Ä–∞—Å—á—ë—Ç–∞</label>
                <select class="form-control" name="scheme_type" id="schemeTypeSelect">
                    <option value="percent">–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —Å—É–º–º—ã –≥—Ä—É–∑–æ–≤</option>
                    <option value="net_percent">–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏</option>
                </select>
            </div>

            <!-- –°—Ö–µ–º–∞ 1: –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —Å—É–º–º—ã –≥—Ä—É–∑–æ–≤ -->
            <div id="percentSchemeBlock">
                <label>–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —Å—É–º–º—ã –≥—Ä—É–∑–æ–≤ (–≥—Ä–æ—Å—Å):</label>
                <div id="commissionTable">
                    <div class="form-row mb-2">
                        <div class="col">
                            <input type="number" step="0.01" class="form-control" name="gross_from_sum[]" placeholder="–æ—Ç —Å—É–º–º—ã ($)">
                        </div>
                        <div class="col">
                            <input type="number" step="0.01" class="form-control" name="gross_percent[]" placeholder="–ü—Ä–æ—Ü–µ–Ω—Ç (%)">
                        </div>
                    </div>
                </div>
                <button type="button" class="btn btn-sm btn-outline-secondary" id="addCommissionRow">+ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É</button>
            </div>

            <!-- –°—Ö–µ–º–∞ 2: –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏ -->
            <div id="netPercentBlock" style="display: none;">
                <label>–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —á–∏—Å—Ç–æ–π –ø—Ä–∏–±—ã–ª–∏:</label>
                <div id="netCommissionTable">
                    <div class="form-row mb-2">
                        <div class="col">
                            <input type="number" step="0.01" class="form-control" name="net_from_sum[]" placeholder="–æ—Ç —Å—É–º–º—ã ($)">
                        </div>
                        <div class="col">
                            <input type="number" step="0.01" class="form-control" name="net_percent[]" placeholder="–ü—Ä–æ—Ü–µ–Ω—Ç (%)">
                        </div>
                    </div>
                </div>
                <button type="button" class="btn btn-sm btn-outline-secondary" id="addNetCommissionRow">+ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É</button>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
          <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ö–µ–º—É</button>
        </div>
      </div>
    </form>
  </div>
</div>

<!-- ‚úÖ –ì—Ä—É–∑—ã -->
<div id="loads-section" class="mt-4">
    <h4>–ì—Ä—É–∑—ã –≤–æ–¥–∏—Ç–µ–ª—è</h4>
    {% if loads %}
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Pickup</th>
                    <th>Delivery</th>
                    <th>Pickup Date</th>
                    <th>Delivery Date</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for load in loads %}
                    <tr>
                        <td>{{ load.pickup_location }}</td>
                        <td>{{ load.delivery_location }}</td>
                        <td>{{ load.pickup_date }}</td>
                        <td>{{ load.delivery_date }}</td>
                        <td>{{ load.status }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>–ù–µ—Ç –≥—Ä—É–∑–æ–≤, –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –Ω–∞ —ç—Ç–æ–≥–æ –≤–æ–¥–∏—Ç–µ–ª—è.</p>
    {% endif %}
</div>
