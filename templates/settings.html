{% extends "base.html" %}
{% block title %}Settings{% endblock %}

{% block sidebar %}
<div class="list-group sidebar">
  <a class="list-group-item list-group-item-action d-flex align-items-center {% if active_tab=='timezone' %}active{% endif %}"
     href="{{ url_for('settings_bp.settings_timezone') }}" data-settings-link>
    <i class="fas fa-clock me-2"></i> Timezone
  </a>
  <a class="list-group-item list-group-item-action d-flex align-items-center {% if active_tab=='permissions' %}active{% endif %}"
     href="{{ url_for('settings_bp.settings_permissions') }}" data-settings-link>
    <i class="fas fa-user-shield me-2"></i> Permissions
  </a>
</div>
{% endblock %}

{% block content %}
<div class="content">
  <div id="settings-content" class="content-section">
    {% if active_tab == 'timezone' %}
      {% include "settings/timezone.html" %}
    {% elif active_tab == 'permissions' %}
      {% include "settings/permissions.html" %}
    {% else %}
      <div class="p-3">Choose a setting on the left.</div>
    {% endif %}
  </div>
</div>

<script src="{{ url_for('static', filename='js/settings_nav.js') }}"></script>

{% if active_tab == 'timezone' %}
  <script src="{{ url_for('static', filename='js/settings.js') }}"></script>
  <script>window.initTimezoneSettings && window.initTimezoneSettings({{ current_tz|tojson|safe }});</script>
{% elif active_tab == 'permissions' %}
  <script src="{{ url_for('static', filename='js/settings_permissions.js') }}"></script>
  <script>window.initPermissions && window.initPermissions();</script>
{% endif %}

<style>
  #settings-content.fade-enter { opacity: 0; transform: translateY(4px); }
  #settings-content.fade-enter-active { opacity: 1; transform: translateY(0); transition: opacity .15s ease, transform .15s ease; }
  .sidebar { min-height: 70vh; }
</style>
{% endblock %}
