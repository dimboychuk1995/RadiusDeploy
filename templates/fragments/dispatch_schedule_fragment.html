<div class="d-flex justify-content-between align-items-center mb-2">
  <div>
    <button class="btn btn-outline-secondary btn-sm me-2" id="prevWeekBtn">← Предыдущая</button>
    <button class="btn btn-outline-secondary btn-sm" id="nextWeekBtn">Следующая →</button>
  </div>
  <div><strong id="weekRangeLabel"></strong></div>
</div>

<table class="table table-bordered table-sm text-center align-middle w-100">
  <thead class="table-light">
    <tr>
      <th style="width: 12%;">Driver</th>
      <th style="width: 10%;">Phone</th>
      <th style="width: 6%;">Truck</th>
      <th style="width: 6%;">Trailer</th>
      {% for i in range(7) %}
        <th style="width: 9%;">
          <span class="day-label-placeholder">Date</span><br>
          <span class="day-name-placeholder">Day</span><br>
          <a href="#">Send list</a>
        </th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for dispatcher in dispatchers %}
      <tr class="table-dark dispatcher-header" data-dispatcher="{{ dispatcher.id }}" style="cursor: pointer;">
        <td colspan="11">{{ dispatcher.username }}</td>
      </tr>
      {% for driver in drivers if driver.dispatcher == dispatcher.id %}
        <tr class="driver-row" data-dispatcher="{{ dispatcher.id }}" data-driver-id="{{ driver.id }}">
          <td>{{ driver.name }}</td>
          <td>{{ driver.contact_number or '' }}</td>
          <td>{{ driver.truck_info.unit_number or 'no truck'}}</td>
          <td><!-- Trailer --></td>
          {% for i in range(7) %}
            <td class="load-cell" data-day="{{ i }}"></td>
          {% endfor %}
        </tr>
      {% endfor %}
    {% endfor %}
  </tbody>
</table>


<!-- Контекстное меню -->
<div id="driverContextMenu" class="dropdown-menu" style="position: absolute; display: none; z-index: 9999;">
  <button class="dropdown-item" id="setBreakBtn">Назначить брейк</button>
  <button class="dropdown-item" id="showOnMapBtn">Водитель на карте</button>
</div>


<!-- ============== Модалка назначения брейка водителю ============== -->
<div class="custom-offcanvas custom-offcanvas-right" id="driverBreakModalDispatch">
  <div class="custom-offcanvas-content">
    <div class="custom-offcanvas-header">
      <h4>Назначить перерыв водителю</h4>
      <button class="btn btn-sm btn-secondary" onclick="closeDriverBreakModalDispatch()">✖</button>
    </div>
    <div class="custom-offcanvas-body">
      <div class="load-modal-content">
        <div class="load-modal-left" style="width: 100%;">
          <form id="driverBreakFormDispatch">
            <div class="mb-3">
              <label for="breakReasonDispatch" class="form-label">Причина</label>
              <select id="breakReasonDispatch" class="form-select">
                <option value="Ремонт">Ремонт</option>
                <option value="Отпуск">Отпуск</option>
                <option value="Выходные">Выходные</option>
                <option value="Supervision">Supervision</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="breakDateRangeDispatch" class="form-label">Диапазон дат</label>
              <input type="text" id="breakDateRangeDispatch" class="form-control" placeholder="Выберите даты">
            </div>
            <div class="text-end mt-4">
              <button type="submit" class="btn btn-primary">Сохранить</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Затемнение -->
<div class="custom-offcanvas-backdrop" id="driverBreakBackdropDispatch" onclick="closeDriverBreakModalDispatch()"></div>
