<div class="container-fluid">
  <h2 class="mb-4">Dispatch Calendars</h2>

  <div class="d-flex justify-content-between align-items-center mb-4">
    <button class="btn btn-outline-secondary btn-sm" id="globalPrevWeekBtn">← Prev Week</button>
    <div class="fw-bold" id="globalWeekLabel"></div>
    <button class="btn btn-outline-secondary btn-sm" id="globalNextWeekBtn">Next Week →</button>
  </div>

  <div class="week-labels d-flex mb-3 px-2" id="weekLabels"></div>

  {% for dispatcher in dispatchers %}
    {% set dispatcher_id = dispatcher._id|string %}
    <div class="dispatcher-block mb-5"
         data-drivers='{{ grouped_drivers.get(dispatcher_id, []) | tojson | safe }}'
         data-loads='{{ all_loads | tojson | safe }}'>
      <h5 class="mb-3">Dispatcher: {{ dispatcher.username }}</h5>
      <div class="driver-calendar-list"></div>
    </div>
  {% endfor %}

  {% set unassigned_id = 'unassigned' %}
  {% if grouped_drivers.get(unassigned_id) %}
    <div class="dispatcher-block mb-5"
         data-drivers='{{ grouped_drivers[unassigned_id] | tojson | safe }}'
         data-loads='{{ all_loads | tojson | safe }}'>
      <h5 class="mb-3">Without a dispatcher</h5>
      <div class="driver-calendar-list"></div>
    </div>
  {% endif %}
</div>
