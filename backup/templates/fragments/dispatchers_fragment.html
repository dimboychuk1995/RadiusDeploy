<div class="p-4">
    <h4>üìã –î–∏—Å–ø–µ—Ç—á–µ—Ä—ã</h4>

    {% if dispatchers %}
        <table class="table table-bordered table-sm">
            <thead>
                <tr>
                    <th>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
                    <th>–ö–æ–º–ø–∞–Ω–∏—è</th>
                    <th>–î–µ—Ç–∞–ª–∏</th>
                </tr>
            </thead>
            <tbody>
                {% for user in dispatchers %}
                <tr>
                    <td>{{ user.username }}</td>
                    <td>{{ user.company }}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick='openDispatcherDetailsModal({{ user | tojson | safe }})'>–î–µ—Ç–∞–ª–∏</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>–ù–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∏—Å–ø–µ—Ç—á–µ—Ä–æ–≤.</p>
    {% endif %}
</div>


<!-- ============== –î–µ—Ç–∞–ª–∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞ (—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–µ) ============== -->
<div class="custom-offcanvas custom-offcanvas-right" id="dispatcherDetailsModal">
  <div class="custom-offcanvas-content">
    <div class="custom-offcanvas-header">
      <h5 class="modal-title">–î–µ—Ç–∞–ª–∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞</h5>
      <button type="button" class="close" onclick="closeDispatcherDetailsModal()">
        <span>&times;</span>
      </button>
    </div>

    <div class="custom-offcanvas-body">
      <input type="hidden" id="dispatcherId">
      <div class="load-modal-content">
        <div class="load-modal-left">
          <div class="form-group">
            <label for="dispatcherRealName">Real Name</label>
            <input type="text" class="form-control" id="dispatcherRealName">
          </div>

          <div class="form-group">
            <label for="dispatcherDispatchName">Dispatch Name</label>
            <input type="text" class="form-control" id="dispatcherDispatchName">
          </div>

          <div class="form-group">
            <label for="dispatcherCompanyDispatch">Company Dispatch</label>
            <select class="form-control" id="dispatcherCompanyDispatch">
              {% for company in companies %}
                <option value="{{ company.id }}">{{ company.name }}</option>
              {% endfor %}
            </select>
          </div>

          <div class="form-group">
            <label for="dispatcherPhone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
            <input type="text" id="dispatcherPhone" class="form-control">
          </div>

          <div class="form-group">
            <label for="dispatcherEmail">Email</label>
            <input type="email" class="form-control" id="dispatcherEmail">
          </div>

          <div class="form-group">
            <label for="dispatcherEmailPassword">Email Password</label>
            <input type="text" class="form-control" id="dispatcherEmailPassword">
          </div>

          <div class="form-group">
            <label>Salary Scheme</label>
            <div class="d-flex justify-content-between align-items-center">
              <span id="dispatcherSalarySchemeText">‚Äî</span>
              <button class="btn btn-sm btn-outline-primary" onclick="openSalarySchemeModal()">Set Salary Scheme</button>
            </div>
          </div>

          <div class="mt-4 d-flex justify-content-end">
            <button class="btn btn-secondary mr-2" onclick="closeDispatcherDetailsModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
            <button class="btn btn-success" onclick="saveDispatcherDetails()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="custom-offcanvas-backdrop" id="dispatcherDetailsBackdrop" onclick="closeDispatcherDetailsModal()"></div>



<!-- ============== –ó–∞—Ä–ø–ª–∞—Ç–∞ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞ (—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–µ) ============== -->
<div class="modal fade" id="salarySchemeModal" tabindex="-1" aria-labelledby="salarySchemeModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="salarySchemeModalLabel">–°—Ö–µ–º–∞ –∑–∞—Ä–ø–ª–∞—Ç—ã</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="salarySchemeSelect">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ö–µ–º—É</label>
          <select id="salarySchemeSelect" class="form-control" onchange="handleSalarySchemeChange()">
            <option value="">‚Äî –í—ã–±—Ä–∞—Ç—å ‚Äî</option>
            <option value="percent">–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –≥—Ä—É–∑–æ–≤</option>
            <option value="fixed_plus_percent">–°—Ç–∞–≤–∫–∞ + –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –≥—Ä—É–∑–æ–≤</option>
            <option value="per_driver_plus_percent">–°—Ç–∞–≤–∫–∞ –∑–∞ –∫–∞–∂–¥–æ–≥–æ –≤–æ–¥–∏—Ç–µ–ª—è + –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –≥—Ä—É–∑–æ–≤</option>
          </select>
        </div>

        <div id="percentBlock" class="form-group mt-3" style="display: none;">
          <label for="salaryPercent">–ü—Ä–æ—Ü–µ–Ω—Ç –∑–∞ –≥—Ä—É–∑—ã (%)</label>
          <input type="number" id="salaryPercent" class="form-control" step="0.1" min="0">
        </div>

        <div id="fixedBlock" class="form-group mt-3" style="display: none;">
          <label for="salaryFixed">–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞ ($)</label>
          <input type="number" id="salaryFixed" class="form-control" step="0.01" min="0">
        </div>

        <div id="perDriverBlock" class="form-group mt-3" style="display: none;">
          <label for="salaryPerDriver">–°—É–º–º–∞ –∑–∞ –∫–∞–∂–¥–æ–≥–æ –≤–æ–¥–∏—Ç–µ–ª—è ($)</label>
          <input type="number" id="salaryPerDriver" class="form-control" step="0.01" min="0">
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
        <button type="button" class="btn btn-primary" onclick="saveSalaryScheme()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    </div>
  </div>
</div>



